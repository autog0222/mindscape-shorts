<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MindScape - XR Visual Therapy [v1.3]</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@100;300;400;500;700;900&family=Orbitron:wght@400;700&display=swap');

        /* --- Scrollbar Hiding & Base Styles --- */
        html {
            scrollbar-width: none; /* Firefox */
            -ms-overflow-style: none; /* IE/Edge */
            scroll-behavior: smooth;
        }
        
        body {
            font-family: 'Noto Sans KR', sans-serif;
            background-color: #050505;
            color: white;
            overflow-x: hidden;
            margin: 0;
            &::-webkit-scrollbar {
                display: none;
            }
        }

        /* 스크롤 잠금 클래스 */
        body.scroll-locked {
            overflow: hidden !important;
            height: 100vh;
        }

        .font-future { font-family: 'Orbitron', sans-serif; }

        /* --- Cinematic Parallax System --- */
        .cinematic-section {
            position: relative;
            width: 100%;
            height: 250vh; 
        }

        .sticky-background {
            position: sticky;
            top: 0;
            left: 0;
            width: 100%;
            height: 100vh;
            overflow: hidden;
            z-index: 0;
        }

        .bg-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 10s ease-out;
        }
        
        .cinematic-section:hover .bg-image {
            transform: scale(1.05);
        }

        .overlay-gradient {
            position: absolute;
            inset: 0;
            background: linear-gradient(to bottom, rgba(0,0,0,0.3), rgba(0,0,0,0.8));
            z-index: 1;
        }

        .scrolling-content {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 10;
            pointer-events: none;
        }

        .story-text {
            position: absolute;
            width: 100%;
            text-align: center;
            opacity: 0;
            transform: translateY(50px);
            transition: all 1s cubic-bezier(0.165, 0.84, 0.44, 1);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 0 20px;
        }

        .story-text.active {
            opacity: 1;
            transform: translateY(0);
        }

        .pos-1 { top: 30vh; }
        .pos-2 { top: 110vh; }
        .pos-3 { top: 190vh; }

        .text-gradient {
            background: linear-gradient(135deg, #e2e8f0 0%, #2dd4bf 100%);
            -webkit-background-clip: text; -webkit-text-fill-color: transparent;
        }

        .glass-panel {
            background: rgba(0, 0, 0, 0.4);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 2rem;
        }

        /* --- XR Viewport Styles --- */
        .xr-viewport {
            perspective: 1000px;
            overflow: hidden;
            position: relative;
            background: #000;
            transform-style: preserve-3d; 
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5); 
        }

        /* Scroll Hint */
        .scroll-hint {
            position: fixed; bottom: 30px; left: 50%; transform: translateX(-50%); z-index: 50;
            animation: bounce 2s infinite; pointer-events: none; opacity: 1; transition: opacity 0.5s;
        }
        .scroll-hint.hidden { opacity: 0; }
        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% {transform: translateX(-50%) translateY(0);}
            40% {transform: translateX(-50%) translateY(-10px);}
            60% {transform: translateX(-50%) translateY(-5px);}
        }

        /* Pricing Card Hover Effect for Light Theme */
        .pricing-card-light:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }
    </style>
</head>
<body>

    <!-- Navigation -->
    <nav id="main-nav" class="fixed w-full z-50 px-6 py-4 bg-gradient-to-b from-black/80 to-transparent backdrop-blur-[2px] transition-transform duration-700 ease-in-out">
        <div class="max-w-7xl mx-auto flex justify-between items-center">
            <div class="text-2xl font-bold font-future tracking-wider text-white flex items-center gap-2 cursor-pointer" onclick="window.scrollTo(0,0)">
                <i data-lucide="brain-circuit" class="text-teal-400"></i>
                MindScape
            </div>
            <div class="hidden md:flex gap-8 text-sm font-light text-gray-300">
                <a href="#story-1" class="hover:text-teal-400 transition">Story</a>
                <a href="#solution" class="hover:text-teal-400 transition">Features</a>
                <a href="#xr-experience" class="hover:text-teal-400 transition">Experience</a>
                <a href="#pricing-section" class="hover:text-teal-400 transition">Pricing</a>
            </div>
            <div class="flex gap-3">
                 <button onclick="toggleAutoScroll()" id="auto-scroll-btn" class="px-4 py-2 rounded-full border border-white/20 hover:bg-white/10 text-white text-xs font-bold transition flex items-center gap-1 w-32 justify-center backdrop-blur-md">
                    <span id="scroll-btn-text">▼ Auto View</span>
                </button>
                <button class="px-5 py-2 rounded-full bg-teal-500 hover:bg-teal-400 text-black font-bold text-sm transition shadow-[0_0_15px_rgba(45,212,191,0.4)]">
                    Pre-order
                </button>
            </div>
        </div>
    </nav>

    <div class="scroll-hint" id="scroll-hint">
        <p class="text-[10px] text-center mb-1 uppercase tracking-widest text-gray-400">Scroll Down</p>
        <i data-lucide="chevron-down" class="w-6 h-6 text-white mx-auto"></i>
    </div>

    <!-- === PART 1: THE PROBLEM (Rainy City) === -->
    <section class="cinematic-section" id="story-1">
        <div class="sticky-background">
            <div class="overlay-gradient"></div>
            <img src="https://images.unsplash.com/photo-1516550893923-42d28e5677af?q=80&w=2944&auto=format&fit=crop" class="bg-image" alt="Gloomy City">
        </div>
        <div class="scrolling-content">
            <div class="story-text pos-1">
                <h2 class="text-5xl md:text-7xl font-bold mb-6 leading-tight drop-shadow-lg">
                    요즘,<br>삶이 힘드신가요?
                </h2>
                <p class="text-xl md:text-2xl text-gray-300 font-light max-w-2xl drop-shadow-md">
                    반복되는 일상, 끝이 보이지 않는 경쟁 속에서<br>마음의 여유를 잃어가고 있지는 않나요?
                </p>
            </div>
            <div class="story-text pos-2">
                <h2 class="text-4xl md:text-6xl font-bold mb-6 leading-tight text-gray-200 drop-shadow-lg">
                    심리상담소 방문,<br>망설여지시나요?
                </h2>
                <div class="flex flex-col gap-4 mt-4 text-lg text-gray-400 font-light">
                    <span class="bg-black/50 px-4 py-2 rounded-full backdrop-blur-sm">"시간이 없어서..."</span>
                    <span class="bg-black/50 px-4 py-2 rounded-full backdrop-blur-sm">"비용이 부담돼서..."</span>
                    <span class="bg-black/50 px-4 py-2 rounded-full backdrop-blur-sm">"누가 알까 봐..."</span>
                </div>
            </div>
             <div class="story-text pos-3">
                <h2 class="text-4xl md:text-6xl font-bold mb-6 leading-tight text-white drop-shadow-lg">
                    단순한 언어치료로는<br>안정을 얻기 힘드신가요?
                </h2>
                <p class="text-xl text-gray-300">
                    말로 설명할 수 없는 감정들은,<br>단순한 대화만으로는 치유되기 어렵습니다.
                </p>
            </div>
        </div>
    </section>

    <!-- === PART 2: THE SOLUTION (Transition to Forest) === -->
    <section class="cinematic-section" id="solution" style="height: 300vh;">
        <div class="sticky-background">
            <div class="overlay-gradient" style="background: linear-gradient(to bottom, rgba(0,0,0,0.7), rgba(0,0,0,0.2));"></div>
            <img src="https://images.unsplash.com/photo-1531306728370-e2ebd9d7bb99?q=80&w=2940&auto=format&fit=crop" class="bg-image" alt="Healing Space">
        </div>
        <div class="scrolling-content">
            <div class="story-text pos-1">
                <span class="text-teal-400 font-future tracking-[0.3em] mb-4 text-sm animate-pulse">THE XR REVOLUTION</span>
                <h2 class="text-6xl md:text-8xl font-bold mb-6 leading-tight">
                    <span class="text-gradient">MindScape</span>
                </h2>
                <p class="text-2xl md:text-3xl font-medium leading-relaxed max-w-4xl">
                    당신의 방이 <strong>치유의 숲</strong>이 됩니다.<br>
                    언어를 넘어선 <span class="text-teal-400">시각적 몰입 치료</span>를 경험하세요.
                </p>
            </div>

            <div class="story-text pos-2">
                <div class="glass-panel max-w-3xl">
                    <div class="flex items-center justify-center mb-6">
                        <div class="p-4 bg-teal-500/20 rounded-full border border-teal-500/50">
                            <i data-lucide="shield-check" class="w-12 h-12 text-teal-400"></i>
                        </div>
                    </div>
                    <h3 class="text-4xl font-bold mb-4">완벽한 보안</h3>
                    <p class="text-lg text-gray-300 leading-relaxed">
                        모든 상담 내역은 클라우드가 아닌, <strong>오직 당신의 XR 기기에만</strong><br>
                        암호화되어 안전하게 저장됩니다.
                    </p>
                </div>
            </div>

            <div class="story-text pos-3">
                <div class="glass-panel max-w-4xl">
                    <h3 class="text-4xl font-bold mb-8">나만의 AI 상담사</h3>
                    <div class="grid md:grid-cols-3 gap-6 text-left">
                        <div class="bg-white/5 p-6 rounded-xl hover:bg-white/10 transition">
                            <div class="mb-4 w-12 h-12 rounded-full bg-purple-500/20 flex items-center justify-center text-purple-400"><i data-lucide="heart-handshake"></i></div>
                            <h4 class="font-bold mb-2">Dr. Aura</h4>
                            <p class="text-sm text-gray-400">따뜻한 공감과 위로</p>
                        </div>
                        <div class="bg-white/5 p-6 rounded-xl hover:bg-white/10 transition">
                            <div class="mb-4 w-12 h-12 rounded-full bg-blue-500/20 flex items-center justify-center text-blue-400"><i data-lucide="lightbulb"></i></div>
                            <h4 class="font-bold mb-2">Prof. Theo</h4>
                            <p class="text-sm text-gray-400">냉철한 분석과 해결</p>
                        </div>
                        <div class="bg-white/5 p-6 rounded-xl hover:bg-white/10 transition">
                            <div class="mb-4 w-12 h-12 rounded-full bg-orange-500/20 flex items-center justify-center text-orange-400"><i data-lucide="sparkles"></i></div>
                            <h4 class="font-bold mb-2">Custom</h4>
                            <p class="text-sm text-gray-400">직접 커스터마이징</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- === PART 3: INTERACTIVE XR EXPERIENCE === -->
    <!-- [VERSION 1.3] Background changed to reference color (#f0fdfa) -->
    <section id="xr-experience" class="bg-gradient-to-b from-[#f0fdfa] to-[#f0fdfa] py-40 px-6 relative z-20 border-t border-white/5 scroll-mt-0">
        <div class="max-w-6xl mx-auto">
            <div class="text-center mb-16">
                <span class="px-3 py-1 rounded-full bg-teal-500/20 text-teal-600 text-xs font-bold uppercase mb-3 inline-block border border-teal-500/30">Interactive Demo</span>
                <h2 class="text-3xl md:text-5xl font-bold mb-4 text-gray-900">MindScape Experience</h2>
                <p class="text-gray-600">화면이 중앙에 오면 시연이 시작됩니다.</p>
            </div>

            <!-- XR Viewport -->
            <div id="xr-viewport" class="relative mx-auto max-w-5xl aspect-video rounded-3xl border-4 border-gray-800 bg-black overflow-hidden shadow-2xl group xr-viewport">
                
                <!-- Simulation Layer -->
                <div id="simulation-container" class="absolute inset-0 z-20">
                    <!-- Backgrounds -->
                    <div id="demo-bg-1" class="absolute inset-0 bg-cover bg-center z-10 transition-opacity duration-[3000ms]" style="opacity: 1;"></div>
                    <div id="demo-bg-2" class="absolute inset-0 bg-cover bg-center z-10 transition-opacity duration-[3000ms]" style="opacity: 0;"></div>
                    <div id="bg-overlay" class="absolute inset-0 bg-gradient-to-t from-black/60 via-transparent to-black/20 z-20 pointer-events-none"></div>

                    <!-- HUD Interface -->
                    <div id="hud-layer" class="absolute inset-0 z-30 p-8 flex flex-col justify-between opacity-0 transition-opacity duration-1000 pointer-events-none">
                        <!-- Top Bar -->
                        <div class="flex justify-between items-start opacity-90">
                            <div class="flex gap-6">
                                <div class="flex flex-col">
                                    <span class="text-[10px] text-teal-400 font-future tracking-widest mb-1">REC ●</span>
                                    <span id="hud-time" class="text-xl text-white font-mono font-light">00:00:00</span>
                                </div>
                                <div class="h-10 w-[1px] bg-white/20"></div>
                                <div class="flex flex-col">
                                    <span class="text-[10px] text-gray-400 font-future tracking-widest mb-1">BIO-SYNC</span>
                                    <div class="flex items-center gap-2">
                                        <i data-lucide="heart" class="w-4 h-4 text-red-500 fill-red-500 animate-pulse"></i>
                                        <span id="hud-bpm" class="text-sm text-white font-mono">108 BPM</span>
                                    </div>
                                </div>
                            </div>
                            <div class="flex gap-3">
                                 <div class="bg-white/10 backdrop-blur px-3 py-1 rounded-full border border-white/20 flex items-center gap-2">
                                    <div class="w-2 h-2 bg-teal-400 rounded-full"></div>
                                    <span class="text-xs text-white font-future">MindScape Active</span>
                                 </div>
                            </div>
                        </div>
                        
                        <!-- Chat Box -->
                        <div class="w-full flex flex-col items-center gap-4">
                            <div id="caption-container" class="bg-black/60 backdrop-blur-md border border-white/10 px-8 py-6 rounded-full text-center transform transition-all duration-500 opacity-0 translate-y-4">
                                <p id="caption-text" class="text-lg md:text-xl text-white font-medium leading-relaxed shadow-black drop-shadow-md">
                                    <!-- Text goes here -->
                                </p>
                            </div>
                            <div id="voice-viz" class="flex gap-1 h-6 items-center opacity-0 transition-opacity duration-500">
                                <div class="w-1 bg-teal-400 h-2 animate-[bounce_1s_infinite]"></div>
                                <div class="w-1 bg-teal-400 h-4 animate-[bounce_1.2s_infinite]"></div>
                                <div class="w-1 bg-teal-400 h-3 animate-[bounce_0.8s_infinite]"></div>
                                <div class="w-1 bg-teal-400 h-5 animate-[bounce_1.1s_infinite]"></div>
                                <div class="w-1 bg-teal-400 h-2 animate-[bounce_0.9s_infinite]"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- PRICING SECTION -->
    <!-- [VERSION 1.3] Background changed to reference color (#f0fdfa) -->
    <section id="pricing-section" class="bg-[#f0fdfa] pb-32 pt-10 px-6">
        <div class="max-w-7xl mx-auto text-center">
            <h2 class="text-3xl md:text-5xl font-bold mb-6 text-gray-900">합리적인 구독 플랜</h2>
            <p class="text-gray-500 mb-12">당신의 마음에 투자하세요. 언제든 해지 가능합니다.</p>
            
            <div class="grid md:grid-cols-3 gap-8 max-w-5xl mx-auto">
                <!-- Starter -->
                <div class="pricing-card-light bg-white border border-gray-200 shadow-xl rounded-3xl p-8 transition duration-300 text-left">
                    <h3 class="text-gray-500 font-bold mb-2">Starter</h3>
                    <div class="text-3xl font-bold text-gray-900 mb-6">Free</div>
                    <ul class="space-y-4 text-sm text-gray-600 mb-8">
                        <li class="flex gap-3"><i data-lucide="check" class="text-teal-600 w-5 h-5"></i> 기본 숲 테마 제공</li>
                        <li class="flex gap-3"><i data-lucide="check" class="text-teal-600 w-5 h-5"></i> AI 상담 일 10분</li>
                    </ul>
                    <button class="w-full py-3 rounded-xl border-2 border-gray-200 hover:border-gray-900 hover:bg-gray-900 text-gray-900 hover:text-white font-bold transition">시작하기</button>
                </div>

                <!-- Monthly (Best) -->
                <div class="pricing-card-light bg-white border-2 border-teal-400 shadow-[0_10px_40px_rgba(45,212,191,0.2)] rounded-3xl p-8 transform md:-translate-y-4 transition duration-300 relative text-left">
                    <div class="absolute top-0 right-0 bg-teal-500 text-white text-xs font-bold px-3 py-1 rounded-bl-xl rounded-tr-2xl shadow-sm">BEST</div>
                    <h3 class="text-teal-600 font-bold mb-2">Monthly</h3>
                    <div class="text-3xl font-bold text-gray-900 mb-6">₩9,900<span class="text-sm font-normal text-gray-500">/월</span></div>
                    <ul class="space-y-4 text-sm text-gray-600 mb-8">
                        <li class="flex gap-3"><i data-lucide="check" class="text-teal-500 w-5 h-5"></i> <strong>모든 테마 무제한</strong></li>
                        <li class="flex gap-3"><i data-lucide="check" class="text-teal-500 w-5 h-5"></i> 4인의 AI 전문 상담사</li>
                        <li class="flex gap-3"><i data-lucide="check" class="text-teal-500 w-5 h-5"></i> 맞춤형 페르소나 생성</li>
                    </ul>
                    <button class="w-full py-3 rounded-xl bg-teal-500 hover:bg-teal-600 text-white font-bold transition shadow-md hover:shadow-lg">구독하기</button>
                </div>

                <!-- Yearly -->
                <div class="pricing-card-light bg-white border border-gray-200 shadow-xl rounded-3xl p-8 transition duration-300 text-left">
                    <h3 class="text-purple-600 font-bold mb-2">Yearly</h3>
                    <div class="text-3xl font-bold text-gray-900 mb-6">₩99,000<span class="text-sm font-normal text-gray-500">/연</span></div>
                    <ul class="space-y-4 text-sm text-gray-600 mb-8">
                        <li class="flex gap-3"><i data-lucide="check" class="text-purple-500 w-5 h-5"></i> 2개월 무료 혜택</li>
                        <li class="flex gap-3"><i data-lucide="check" class="text-purple-500 w-5 h-5"></i> Monthly 모든 혜택 포함</li>
                    </ul>
                    <button class="w-full py-3 rounded-xl border border-purple-200 text-purple-600 hover:bg-purple-50 font-bold transition">연간 구독</button>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <!-- [VERSION 1.3] Background changed to reference color (#f0fdfa) -->
    <footer class="bg-[#f0fdfa] py-12 text-center text-gray-400 text-xs border-t border-gray-200">
        <p>&copy; 2026 MindScape. All rights reserved.</p>
        <p class="mt-2">본 서비스는 의료 행위를 대체하지 않으며, 심리 안정을 위한 보조 수단입니다.</p>
    </footer>

    <script>
        // --- Configuration & Elements ---
        const siteConfig = {
            images: {
                bg1: 'https://images.unsplash.com/photo-1486406146926-c627a92ad1ab?q=80&w=2940&auto=format&fit=crop',
                bg2: 'https://images.unsplash.com/photo-1542273917363-3b1817f69a2d?q=80&w=2948&auto=format&fit=crop',
            }
        };

        const simulationContainer = document.getElementById('simulation-container');
        const hudLayer = document.getElementById('hud-layer');
        const demoBg1 = document.getElementById('demo-bg-1');
        const demoBg2 = document.getElementById('demo-bg-2');
        const bgOverlay = document.getElementById('bg-overlay');
        const captionContainer = document.getElementById('caption-container');
        const captionText = document.getElementById('caption-text');
        const voiceViz = document.getElementById('voice-viz');
        const hudTime = document.getElementById('hud-time');
        const hudBpm = document.getElementById('hud-bpm');
        const xrSection = document.getElementById('xr-experience');
        const nav = document.getElementById('main-nav');

        // --- Safe Initialization ---
        (function init() {
            if (typeof lucide !== 'undefined' && lucide.createIcons) lucide.createIcons();
            else window.addEventListener('load', () => lucide.createIcons());

            if(demoBg1) demoBg1.style.backgroundImage = `url('${siteConfig.images.bg1}')`;
            if(demoBg2) demoBg2.style.backgroundImage = `url('${siteConfig.images.bg2}')`;

            const scrollHint = document.getElementById('scroll-hint');
            if(scrollHint) {
                window.addEventListener('scroll', () => {
                    if (window.scrollY > 100) scrollHint.classList.add('hidden');
                    else scrollHint.classList.remove('hidden');
                });
            }

            // General Scroll Animations
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) entry.target.classList.add('active');
                    else entry.target.classList.remove('active');
                });
            }, { root: null, rootMargin: '0px', threshold: 0.2 });

            document.querySelectorAll('.story-text').forEach((el) => observer.observe(el));

            // [VERSION 1.1] Start Logic for Scroll Locking & Delay
            let hasStarted = false;

            // XR Experience Observer
            const simObserver = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    // 1. 섹션이 60% 이상 보이고 아직 시작 안 했으면
                    if (entry.isIntersecting && !hasStarted) {
                        hasStarted = true;
                        
                        // [VERSION 1.1] Step A: 강제 스크롤 이동 및 잠금
                        lockScrollAtSection();

                        // [VERSION 1.1] Step B: 2.5초 (2500ms) 대기 후 시뮬레이션 시작
                        setTimeout(() => {
                            if(hudLayer) hudLayer.style.opacity = '1'; 
                            startSimulationFlow();
                        }, 2500);
                    }
                });
            }, { threshold: 0.6 });

            if(xrSection) simObserver.observe(xrSection);
        })();

        // [VERSION 1.1 & 1.3] Helper Function: Lock Scroll
        function lockScrollAtSection() {
            // [VERSION 1.3] 자동 스크롤 중이었다면 상태 저장
            if(isScrolling) {
                wasAutoScrolling = true;
                toggleAutoScroll(); // Stop it for now to lock properly
            }

            // 부드럽게 해당 섹션으로 이동
            if(xrSection) {
                xrSection.scrollIntoView({ behavior: 'smooth', block: 'center' });
            }

            // 이동 애니메이션 시간을 고려해 약간 뒤에 body overflow hidden 처리
            setTimeout(() => {
                document.body.classList.add('scroll-locked');
                if(nav) nav.classList.add('-translate-y-full'); // Nav 숨김
            }, 500);
        }

        // [VERSION 1.1 & 1.3] Helper Function: Unlock Scroll
        function unlockScroll() {
            document.body.classList.remove('scroll-locked');
            if(nav) nav.classList.remove('-translate-y-full'); // Nav 표시
            
            // [VERSION 1.3] 자동 스크롤로 왔던 경우, 시연 종료 후 다시 스크롤 재개
            if(wasAutoScrolling) {
                wasAutoScrolling = false;
                setTimeout(() => {
                    // 사용자 경험을 위해 잠시 대기 후 출발
                    toggleAutoScroll();
                }, 800);
            }
            console.log("Scroll Unlocked");
        }

        // --- Auto View Logic (Modified for Cursor Hiding & Resume) ---
        let scrollInterval;
        let isScrolling = false;
        let wasAutoScrolling = false; // [VERSION 1.3] State to remember if auto scroll was active

        window.toggleAutoScroll = function() {
            const btnText = document.getElementById('scroll-btn-text');
            const html = document.documentElement;
            
            if (isScrolling) {
                // Stop manually
                cancelAnimationFrame(scrollInterval);
                isScrolling = false;
                if(btnText) btnText.innerText = '▼ Auto View';
                html.style.scrollBehavior = 'smooth';
                // [VERSION 1.3] Restore cursor
                document.body.style.cursor = 'default'; 
            } else {
                // Start
                isScrolling = true;
                if(btnText) btnText.innerText = '❚❚ Stop Auto';
                html.style.scrollBehavior = 'auto'; 
                // [VERSION 1.3] Hide cursor
                document.body.style.cursor = 'none';
                
                function step() {
                    if (!isScrolling) return;
                    
                    window.scrollBy({ top: 2, left: 0, behavior: "auto" });
                    
                    if ((window.innerHeight + window.scrollY) >= document.body.offsetHeight - 5) {
                        isScrolling = false;
                        if(btnText) btnText.innerText = '▼ Auto View';
                        html.style.scrollBehavior = 'smooth';
                        // [VERSION 1.3] Restore cursor at bottom
                        document.body.style.cursor = 'default';
                        return;
                    }
                    
                    scrollInterval = requestAnimationFrame(step);
                }
                
                scrollInterval = requestAnimationFrame(step);
            }
        };

        // --- Extended Dialogue Scenario ---
        const dialogues = [
            { text: "User: 요즘 회사 일이 너무 많아서 숨이 막히는 것 같아요. 번아웃이 온 것 같아...", type: "user", delay: 1000 },
            { text: "AI Counselor: 많이 힘드시겠어요. 숨 쉴 틈 없이 달려오느라 마음이 지치신 것 같네요.", type: "avatar", delay: 5000 },
            { text: "User: 맞아. 집에 와도 쉰 것 같지가 않고 계속 불안해.", type: "user", delay: 9000 },
            { text: "AI Counselor: 그렇다면 잠시 복잡한 생각을 멈출 수 있는 곳으로 가보는 건 어떨까요?", type: "avatar", delay: 13000 },
            { text: "AI Counselor: 당신을 위해 평화로운 '비 갠 뒤의 숲'을 준비했습니다.", type: "avatar", delay: 17000 },
            
            // Transition Trigger
            { text: "Environment shifting...", type: "system", delay: 20000 },
            
            { text: "AI Counselor: 공간이 바뀌었습니다. 싱그러운 숲 냄새가 느껴지시나요?", type: "avatar", delay: 24000 },
            { text: "AI Counselor: 저와 함께 깊게 호흡해봐요. 숨을 들이마시고... 내쉬고...", type: "avatar", delay: 28000 },
            { text: "User: (깊은 한숨) 하아... 공기가 맑아진 느낌이야.", type: "user", delay: 33000 },
            { text: "AI Counselor: 잘하셨어요. 이곳에서는 어떤 업무 알림도 울리지 않아요.", type: "avatar", delay: 37000 },
            { text: "AI Counselor: 지금 당신은 충분히 잘하고 있어요. 잠시 멈춰도 괜찮습니다.", type: "avatar", delay: 41000 },
            { text: "User: 고마워. 마음이 한결 가벼워진 것 같아.", type: "user", delay: 46000 },
            { text: "AI Counselor: 언제든 마음이 무거울 때 다시 찾아와 주세요. 편안한 밤 되세요.", type: "avatar", delay: 50000 },
             // [VERSION 1.1] 시뮬레이션 종료 시 스크롤 잠금 해제 트리거
             { text: "Session Ending...", type: "system", delay: 54000 }
        ];

        function updateCaption(text, type) {
            if(!captionContainer || !captionText) return;

            captionContainer.style.opacity = '0';
            if(voiceViz) voiceViz.style.opacity = '0';

            setTimeout(() => {
                if (type === 'user') {
                    captionText.innerHTML = `<span class="text-teal-400 font-bold text-sm block mb-1">USER</span>${text.replace('User: ', '')}`;
                    if(voiceViz) voiceViz.style.opacity = '1';
                } else if (type === 'avatar') {
                    captionText.innerHTML = `<span class="text-purple-400 font-bold text-sm block mb-1">AI COUNSELOR</span>${text.replace('AI Counselor: ', '')}`;
                } else {
                    captionText.innerHTML = `<span class="text-gray-400 italic text-sm">${text}</span>`;
                }
                captionContainer.style.opacity = '1';
            }, 500);
        }

        let clockInterval, bpmInterval;
        let currentBpm = 118, targetBpm = 118; // Start High

        function startClock() {
            if(clockInterval) clearInterval(clockInterval);
            const updateTime = () => {
                const now = new Date();
                if(hudTime) hudTime.innerText = now.toLocaleTimeString('en-GB', { hour12: false });
            };
            updateTime();
            clockInterval = setInterval(updateTime, 1000);
        }

        function startHeartRateMonitor() {
            if(bpmInterval) clearInterval(bpmInterval);
            currentBpm = 118; targetBpm = 118;
            bpmInterval = setInterval(() => {
                const diff = targetBpm - currentBpm;
                const change = diff * 0.1;
                const noise = (Math.random() - 0.5) * 3;
                currentBpm += change + (Math.random() > 0.7 ? noise : 0);
                if(currentBpm > 130) currentBpm = 130;
                if(currentBpm < 60) currentBpm = 60;
                if(hudBpm) hudBpm.innerText = `${Math.round(currentBpm)} BPM`;
            }, 800);
        }

        function startSimulationFlow() {
            startClock();
            startHeartRateMonitor();
            
            dialogues.forEach((line) => {
                setTimeout(() => {
                    updateCaption(line.text, line.type);
                    if(line.text.includes("Environment shifting")) {
                        if(demoBg1) demoBg1.style.opacity = "0";
                        setTimeout(() => {
                            if(demoBg2) demoBg2.style.opacity = "1"; 
                            if(bgOverlay) { bgOverlay.classList.remove('from-black/60'); bgOverlay.classList.add('from-black/30'); }
                            targetBpm = 72;
                        }, 2000);
                    }
                    if(line.text.includes("Session Ending")) {
                        if(hudLayer) hudLayer.style.opacity = '0';
                        // [VERSION 1.1] 시뮬레이션 끝난 후 잠금 해제 호출
                        setTimeout(() => { unlockScroll(); }, 1000); 
                    }
                }, line.delay);
            });
        }
    </script>
</body>
</html>
